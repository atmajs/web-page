(function(t){function e(){}function n(){}function r(t,e,n){if(t instanceof Array){for(var i,o=[],s=0,u=t.length;u>s;s++)i=r(t[s],e,n),t[s].tagName===l&&u-1>s&&t[s+1].tagName===a&&(s+=1,null==i&&(i=r(t[s].nodes,e,n))),null!=i&&(i instanceof Array?o=o.concat(i):o.push(i));return o}if(null!=t.content)return{content:t.content,type:t.type};if(t.tagName===l){var c=t.attr.id?e[t.attr.id]:n;return c?null==t.nodes?c:r(t.nodes,e,c):null}var f={tagName:t.tagName||t.compoName,attr:t.attr,type:t.type,controller:t.controller};return t.nodes&&(f.nodes=r(t.nodes,e,n)),f}function i(t,e){if(null==e&&(e={}),t instanceof Array){for(var n=t,r=0,s=n.length;s>r;r++)i(n[r],e);return e}var l=t.tagName;if(null!=l&&l===u){var a=t.attr.id;!a&&console.error("@content has no id specified",t),e[a]&&console.error("@content already exists",a),e[a]=o(t)}return null!=t.nodes&&i(t.nodes,e),e}function o(t){for(var e,n=t.parent;null!=n&&n.tagName!==c;){var r={type:n.type,tagName:n.tagName,attr:n.attr,controller:n.controller,nodes:null};null==e?(e=r,e.nodes=t.nodes):e.nodes=[r],n=n.parent}return null!=e?e:t.nodes}var s=t.mask||Mask,u="@content",l="@placeholder",a="@else",c="layout:view",f="layout:master",h={};e.prototype={constructor:e,render:function(){h[this.attr.id]=this}},s.registerHandler(f,e),n.prototype={constructor:n,renderStart:function(){var t=h[this.attr.master];return null==t?(console.error("Master Layout is not defined for",this),void 0):(null==this.contents&&(this.contents=i(this.nodes),Object.keys&&0===Object.keys(this.contents).length&&console.warn("no contents: @content #someID")),this.nodes=r(t,this.contents).nodes,void 0)}},s.registerHandler(c,n)})(this);